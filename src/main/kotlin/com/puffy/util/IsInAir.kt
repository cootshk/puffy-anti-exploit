package com.puffy.util

import net.minecraft.server.network.ServerPlayerEntity

private const val Y_BIAS = 0.2

fun ServerPlayerEntity.isInAir(): Boolean {
    val world = this.entityWorld
    val boundingBox = this.boundingBox.expand(0.0, Y_BIAS, 0.0)

    val collidingBlocks = world.getBlockCollisions(this, boundingBox)
    val collidingEntities =
        world.getOtherEntities(this, boundingBox) { entity -> !entity.equals(this) }

    return !collidingBlocks.any() && !collidingEntities.any()
}
